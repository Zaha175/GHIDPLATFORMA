<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MPU Pregătire - Întrebări și Răspunsuri</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        /* --- Farbvariablen --- */
        :root {
            --primary-color: #5D5CDE;
            --secondary-color: #4B4AAA;
            --success-color: #48BB78;
            --warning-color: #ED8936;
            --error-color: #F56565;
            --light-bg: #FFFFFF;
            --dark-bg: #181818;
            --light-text: #333333;
            --dark-text: #F0F0F0;
            /* Neue Farben für Kategorie-Buttons */
            --category-btn-dark-blue: #16213E;
            --category-btn-dark-blue-hover: #1A365D;
            --category-btn-dark-yellow: #F7DC6F;
            /* Spezifische Farbe für Extra-Guide-Button (optional, hier Standardstil) */
            --guide-extra-btn-color: #0d9488; /* Teal */
            --guide-extra-btn-hover-color: #0f766e;
        }

        /* --- Dark Mode Stile --- */
        body.dark {
            background-color: var(--dark-bg);
            color: var(--dark-text);
        }
        body.dark .bg-white { background-color: #222 !important; }
        body.dark .bg-gray-100 { background-color: #2a2a2a !important; }
        body.dark .text-gray-800 { color: #f0f0f0 !important; }
        body.dark .text-gray-700 { color: #e0e0e0 !important; }
        body.dark .text-gray-600 { color: #d0d0d0 !important; }
        body.dark .text-gray-500 { color: #c0c0c0 !important; }
        body.dark .border-gray-200 { border-color: #444 !important; }
        body.dark .bg-gray-50 { background-color: #333 !important; }
        body.dark .exercise-tab { background-color: #333 !important; color: #f0f0f0 !important; }
        body.dark .exercise-tab.active { background-color: var(--primary-color) !important; color: white !important; }
        body.dark input, body.dark textarea, body.dark select { background-color: #333 !important; color: #f0f0f0 !important; border-color: #555 !important; }
        body.dark .record-button { background-color: #333 !important; }
        body.dark .record-button.recording { background-color: #F56565 !important; }
        body.dark .diff-highlight-add { background-color: rgba(74, 222, 128, 0.2) !important; }
        body.dark .diff-highlight-remove { background-color: rgba(248, 113, 113, 0.2) !important; }
        body.dark .btn-special { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); }
        body.dark .toggle-dark-mode { background-color: var(--primary-color); }
        body.dark .toggle-dark-mode::after { transform: translateX(26px); }
        body.dark .modal-content { background-color: #222; color: #f0f0f0; }
        body.dark .close:hover, body.dark .close:focus { color: white; }
        /* Dark Mode Stile für Kategorie-Buttons */
        body.dark .category-tab {
            background-color: var(--category-btn-dark-yellow); /* Dunkelgelb */
            color: black;
        }
        body.dark .category-tab.active {
            background-color: var(--category-btn-dark-blue); /* Dunkelblau */
            color: white;
        }
        body.dark .category-tab:hover {
             background-color: #e6c85e; /* Etwas dunkleres Gelb beim Hover */
        }
         body.dark .category-tab.active:hover {
             background-color: var(--category-btn-dark-blue-hover); /* Dunkelblau Hover für aktiv */
         }

        /* --- Stile für Kategorie-Buttons --- */
        .category-tab {
            background-color: var(--category-btn-dark-blue); /* Dunkelblau */
            color: white;
            padding: 15px 30px; /* Vergrößert die Buttons */
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center; /* Zentriert den Text */
            flex-shrink: 0; /* Verhindert das Schrumpfen der Buttons */
        }
        .category-tab:hover {
            background-color: var(--category-btn-dark-blue-hover); /* Etwas dunkler beim Hover */
        }
        .category-tab.active {
            background-color: var(--category-btn-dark-yellow); /* Dunkelgelb für aktiv */
            color: black;
        }
        /* Stil für Extra-Guide-Button (verwendet denselben Stil wie .category-tab) */
        .guide-extra-button { }
        .guide-extra-button:hover { }

        /* Container für Kategorie-Buttons */
        .category-button-container { }


        /* --- Stile für Werbebanner --- */
        #ad-banner {
          text-align: center;
          padding: 15px;
          background-color: rgba(0, 51, 102, 0.8); /* Banner-Hintergrund */
          color: #ffd700; /* Banner-Textfarbe (Gold) */
          margin: 20px auto 10px auto; /* Rand oben hinzugefügt */
          max-width: 1400px;
          border-radius: 5px;
          border: 1px solid #ffd700; /* Banner-Rand */
          font-size: 1.2rem;
          font-weight: bold;
          min-height: 1.5em; /* Mindesthöhe, um Kollaps zu verhindern */
          cursor: default;
          position: relative;
          overflow: hidden;
          animation: pulse 3s infinite ease-in-out; /* Hintergrund-Puls-Animation */
        }

        @keyframes pulse {
          0% { box-shadow: 0 0 10px 0px rgba(255, 215, 0, 0.5); }
          50% { box-shadow: 0 0 20px 5px rgba(255, 215, 0, 0.7); }
          100% { box-shadow: 0 0 10px 0px rgba(255, 215, 0, 0.5); }
        }

        #ad-banner .text-glow {
          animation: textGlow 2s ease-in-out infinite alternate; /* Text-Glüh-Animation */
        }

        @keyframes textGlow {
          from {
            text-shadow: 0 0 5px #ffd700, 0 0 10px #ffd700;
          }
          to {
            text-shadow: 0 0 10px #ffd700, 0 0 20px #ffd700, 0 0 30px #ff9900;
          }
        }

        .cursor { /* Blinkender Cursor-Stil */
          display: inline-block;
          width: 3px;
          height: 1.2em;
          background-color: #ffd700; /* Cursor-Farbe */
          margin-left: 2px;
          animation: blink 1s infinite;
          vertical-align: bottom;
        }

        @keyframes blink {
          0%, 49% { opacity: 1; }
          50%, 100% { opacity: 0; }
        }

        /* Dark Mode Variante für Banner */
        body.dark #ad-banner { /* Korrigierter Selektor */
          background-color: rgba(68, 68, 68, 0.8);
          border-color: #777;
          animation: pulseDark 3s infinite ease-in-out;
        }

        @keyframes pulseDark {
          0% { box-shadow: 0 0 10px 0px rgba(119, 119, 119, 0.5); }
          50% { box-shadow: 0 0 20px 5px rgba(119, 119, 119, 0.7); }
          100% { box-shadow: 0 0 10px 0px rgba(119, 119, 119, 0.5); }
        }

        body.dark #ad-banner .cursor { /* Korrigierter Selektor */
          background-color: #ddd;
        }

        /* Animationspause beim Hover */
        #ad-banner:hover {
          animation-play-state: paused;
        }

        #ad-banner:hover .text-glow {
          animation-play-state: paused;
        }
        #ad-banner:hover .cursor { /* Stoppt auch den Cursor beim Hover */
            animation-play-state: paused;
        }


        /* --- Andere allgemeine Stile --- */
        .question-card { transition: transform 0.2s ease, box-shadow 0.2s ease; }
        .question-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .answer-section { transition: max-height 0.3s ease, opacity 0.3s ease; max-height: 0; opacity: 0; overflow: hidden; }
        .answer-section.show { max-height: 5000px; opacity: 1; }
        .personal-example { border-left: 4px solid var(--primary-color); }
        .tips-container { border-left: 4px solid var(--success-color); }
        .warning-container { border-left: 4px solid var(--warning-color); }
        .record-button { transition: all 0.3s ease; }
        .record-button.recording { background-color: var(--error-color); animation: pulse 1.5s infinite; }
        /* Keyframe pulse wurde bereits oben definiert */
        #recordingIndicator { transition: opacity 0.3s ease; }
        .highlight-text { background-color: rgba(93, 92, 222, 0.1); padding: 0 2px; border-radius: 2px; }
        .audio-player { width: 100%; margin-top: 8px; }
        .blinking { animation: blink 1s infinite; }
        /* Keyframe blink wurde bereits oben definiert */
        .feedback-container { transition: all 0.3s ease; }
        .question-list { max-height: calc(100vh - 350px); overflow-y: auto; }
        .progress-container { height: 6px; background-color: #e2e8f0; border-radius: 3px; overflow: hidden; }
        .progress-bar { height: 100%; background-color: var(--primary-color); width: 0%; transition: width 0.5s ease; }
        .question-list::-webkit-scrollbar { width: 6px; }
        .question-list::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .question-list::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        .question-list::-webkit-scrollbar-thumb:hover { background: #555; }
        .diff-highlight-add { background-color: rgba(74, 222, 128, 0.1); border-left: 3px solid #4ADE80; padding-left: 8px; margin: 4px 0; }
        .diff-highlight-remove { background-color: rgba(248, 113, 113, 0.1); border-left: 3px solid #F87171; padding-left: 8px; margin: 4px 0; text-decoration: line-through; }
        .loading-spinner { border: 3px solid rgba(93, 92, 222, 0.3); border-radius: 50%; border-top: 3px solid var(--primary-color); width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .tab-content { max-height: 2000px; transition: max-height 0.5s ease; overflow: hidden; }
        .tab-content.hidden { max-height: 0; }
        #video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; margin-bottom: 20px; }
        #video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .image-wrapper { margin: 20px 0; text-align: center; }
        .answer-image { max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .btn-special { background-color: var(--primary-color); color: white; padding: 10px 20px; border-radius: 5px; font-weight: bold; display: inline-block; margin: 10px 0; text-align: center; cursor: pointer; transition: all 0.3s ease; }
        .btn-special:hover { background-color: var(--secondary-color); transform: translateY(-2px); }
        .toggle-dark-mode { cursor: pointer; position: relative; width: 50px; height: 24px; background-color: #ccc; border-radius: 20px; transition: all 0.3s; }
        .toggle-dark-mode::after { content: ''; position: absolute; width: 20px; height: 20px; border-radius: 50%; top: 2px; left: 2px; background-color: white; transition: all 0.3s; }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.5); }
        .modal-content { background-color: #fefefe; margin: 10% auto; padding: 20px; border-radius: 8px; width: 80%; max-width: 700px; max-height: 80vh; overflow-y: auto; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover, .close:focus { color: black; text-decoration: none; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-8 text-center">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-3xl font-bold text-gray-800">MPU Pregătire - Întrebări și Răspunsuri</h1>
                <div class="flex items-center">
                    <span class="mr-2 text-sm text-gray-600">Mode:</span>
                    <div id="darkModeToggle" class="toggle-dark-mode"></div>
                </div>
            </div>
            <p class="text-gray-600 max-w-2xl mx-auto">Exersează răspunsurile pentru MPU și îmbunătățește-le cu exemple personale detaliate!</p>
        </header>

        <div id="ad-banner">
          <span class="text-glow"></span><span class="cursor"></span>
        </div>

        <div class="category-button-container flex flex-wrap gap-5 justify-start mt-5 mb-6">
            <button class="category-tab active" data-category="all">Toate</button>
            <button class="category-tab" data-category="intro">Introducere</button>
            <button class="category-tab" data-category="incident">Incident</button>
            <button class="category-tab" data-category="alcohol">Alcool</button>
            <button class="category-tab" data-category="recovery">Recuperare</button>
            <button class="category-tab" data-category="future">Viitor</button>
            <button class="category-tab guide-extra-button" onclick="window.open('https://zaha175.github.io/GHIDPENTRURASPUNSURI/', '_blank')">
                Ghid Răspunsuri
            </button>
        </div>

        <div id="guideModal" class="modal">
            <div class="modal-content">
                <span class="close" id="closeGuideModal">×</span>
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Ghid pentru răspunsuri autentice la MPU</h2>
                <div class="space-y-6">
                    <p><strong>Autenticitate și Onestitate:</strong> Răspundeți sincer. Psihologul va detecta răspunsurile memorate sau neautentice.</p>
                    <p><strong>Reflecție Personală:</strong> Demonstrați că ați reflectat asupra comportamentului trecut și ați înțeles cauzele.</p>
                    <p><strong>Schimbare Comportamentală:</strong> Arătați schimbări concrete și stabile în comportamentul și atitudinea dumneavoastră.</p>
                    <p><strong>Exemple Concrete:</strong> Folosiți exemple din viața personală pentru a ilustra punctele cheie.</p>
                    <p><strong>Planuri de Viitor:</strong> Prezentați strategii clare pentru a evita recidiva și a menține un comportament responsabil.</p>
                    <p><strong>Consecvență:</strong> Asigurați-vă că răspunsurile sunt consecvente pe parcursul întregii examinări.</p>
                    <p><strong>Gestionarea Emoțiilor:</strong> Rămâneți calm și deschis, chiar și la întrebări dificile.</p>
                </div>
            </div>
        </div>

        <div class="flex flex-col md:flex-row gap-6">
            <div class="w-full md:w-1/3 mb-6 md:mb-0">
                <div class="bg-white rounded-lg shadow-md p-4 mb-6">
                     <div class="relative">
                        <input type="text" id="searchInput" class="w-full rounded-lg border border-gray-300 px-4 py-2 pr-10 text-base focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="Caută întrebări...">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 absolute right-3 top-3 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-4 mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Progresul tău</h2>
                     <div class="mb-4">
                        <div class="flex justify-between mb-1 text-sm">
                            <span>Întrebări vizualizate</span>
                            <span id="answeredQuestions">0/0</span>
                        </div>
                        <div class="progress-container">
                            <div id="progressBar" class="progress-bar"></div>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-3 text-center">
                        <div class="bg-green-50 p-2 rounded-lg">
                            <p class="text-sm text-gray-600">Înregistrate</p>
                            <p id="recordedAnswers" class="font-semibold text-lg">0</p>
                        </div>
                        <div class="bg-blue-50 p-2 rounded-lg">
                            <p class="text-sm text-gray-600">Salvate</p>
                            <p id="savedAnswers" class="font-semibold text-lg">0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-4">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Sfaturi utile</h2>
                     <div class="space-y-3">
                        <div class="tips-container pl-3">
                            <p class="text-sm text-gray-700">Ia-ți timp să te gândești. O pauză scurtă înainte de a răspunde pare mai naturală.</p>
                        </div>
                        <div class="tips-container pl-3">
                            <p class="text-sm text-gray-700">Folosește formulări precum "Am învățat că..." sau "Am experimentat..." în loc de "Trebuie să..."</p>
                        </div>
                        <div class="warning-container pl-3">
                            <p class="text-sm text-gray-700">Evită să răspunzi prea rapid sau să folosești excesiv termeni tehnici.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="w-full md:w-2/3">
                <div id="questionListContainer" class="bg-white rounded-lg shadow-md p-4 mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Întrebări</h2>
                    <div id="questionList" class="question-list space-y-4">
                        </div>
                </div>
                <div id="questionDetail" class="bg-white rounded-lg shadow-md p-6 hidden">
                    <div class="mb-4">
                        <button id="backToList" class="flex items-center text-indigo-600 hover:text-indigo-800">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                            </svg>
                            Înapoi la listă
                        </button>
                    </div>
                    <div class="mb-6">
                        <span id="questionCategory" class="inline-block px-2 py-1 text-xs rounded-full bg-indigo-100 text-indigo-800 mb-2">Categorie</span>
                        <h3 id="questionTitle" class="text-xl font-bold text-gray-800 mb-3">Se încarcă întrebarea...</h3>
                    </div>
                    <div id="questionAnswer" class="mb-6 p-4 bg-gray-50 rounded-lg">
                        </div>
                    <div class="mt-4">
                        <div class="flex flex-wrap space-x-2">
                            <button id="recordAnswerBtn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                                </svg>
                                Înregistrează răspunsul tău
                            </button>
                            <button id="saveAnswerBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                                </svg>
                                Salvează răspunsul
                            </button>
                        </div>
                    </div>
                    <div id="recordingContainer" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
                        <h4 class="font-semibold mb-3">Înregistrare răspuns:</h4>
                        <div class="flex items-center space-x-4">
                            <button id="recordButton" class="record-button flex items-center justify-center w-12 h-12 rounded-full bg-gray-200 hover:bg-gray-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                                </svg>
                            </button>
                            <div>
                                <p id="recordingIndicator" class="text-sm text-gray-500 hidden">
                                    <span class="inline-block w-2 h-2 bg-red-500 rounded-full mr-1 blinking"></span>
                                    Înregistrare în curs...
                                </p>
                                <p id="recordingTime" class="text-sm font-mono">00:00</p>
                            </div>
                        </div>
                        <div id="audioContainer" class="mt-4 hidden">
                            <audio id="audioPlayer" controls class="audio-player"></audio>
                            <div class="flex mt-3 space-x-2">
                                <button id="reRecordButton" class="px-3 py-1 text-sm rounded border border-gray-300 hover:bg-gray-100">
                                    Înregistrează din nou
                                </button>
                                <button id="saveRecordingButton" class="px-3 py-1 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700">
                                    Salvează înregistrarea
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 flex justify-between">
                        <button id="prevQuestionButton" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700">
                            Întrebarea anterioară
                        </button>
                        <button id="nextQuestionButton" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
                            Următoarea întrebare
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // *** NEUE DATENBANK MIT FRAGEN UND ANTWORTEN ***
        const qa_data = [
           {
                "question": "De ce veniți la MPU? De ce sunteți astăzi aici?",
                "answer": "Sunt aici la MPU pentru că am condus sub influența alcoolului, nu am respectat legea, am făcut un accident, am fost un egoist, am fost un pericol pentru mine și pentru alții! Mi-am dat seama că am o problemă cu alcoolul, am fost în abuz de alcool, și am încetat să beau. Astăzi aș vrea să vă arăt că m-am schimbat și că acum sunt capabil să conduc responsabil.",
                "category": "intro" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "De ce credeți că autoritățile sunt îngrijorate cu privire la capacitatea dvs. de a conduce un vehicul? Sunteți de acord că veniți la MPU?",
                "answer": "Da sunt de acord pentru că am condus sub influența alcoolului și am făcut un accident! Acest lucru este o infracțiune gravă care a pus în pericol viața mea și a altora!",
                "category": "intro" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Descrieți ziua delictului din punctul dvs. de vedere cu data și ora?",
                "answer": "09.10.2022 Duminică, Am avut accident la ora 3:40.\n\nConduceam pe strada Nördlinger spre strada Seewiesenbrücke din Heidenheim, din cauza consumului de alcool, am lovit semaforul din mijlocul străzii și am rămas suspendat pe stradă cu mașina. Prietenul meu din mașină a fost ușor rănit.\n\nProba de sânge la 04:27 a avut 2,76 Promile.\n\nÎnceputul consumului de alcool până la colectarea sângelui: 10 ore!\n\nSâmbătă, 08.10.2022, zi de naștere\n\nAm început să consum alcool de la 18:30 până la 03:30. Am fost patru prieteni. Am băut 12 sticle de bere (jumătate), 6 Litri de bere (5%) + 4 duble țuică (șnaps) (40 ml, 40 Vol.-%).",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ați plănuit să consumați în ziua respectivă atât de mult?",
                "answer": "Nu, nu a fost planificat!\n\nNu am avut controlul asupra consumului, asta este problema, consumul mi-a scăpat de sub control în timpul petrecerii!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cum ați dorit inițial să mergeți acasă, cum ați planificat acest lucru și de ce v-ați abătut de la plan?",
                "answer": "Am vrut inițial să las mașina acolo și să ne întoarcem pe jos acasă, dar m-am hotărât, din confort, să conduc spre casă.\n\nDecizia, clar, a fost greșită și iresponsabilă, am făcut ceva ilegal, conducând sub influența alcoolului. Am făcut un accident!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
             // Frage 6: Die ursprüngliche Frage war Teil der Antwort von Frage 5. Hier als separate Frage formatiert.
            {
                "question": "Ați crezut că mai puteți conduce în siguranță?",
                "answer": "Da, m-am simțit în stare să conduc. Din perspectiva de astăzi, desigur, nu a fost cazul!\n\nAcum înțeleg că siguranța circulației este cel mai important lucru. Ar fi trebuit să refuz și să spun nu. Îmi pare foarte rău pentru cele întâmplate!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ce efecte are alcoolul asupra capacității de conducere?",
                "answer": "Reacție slabă, vedere tunel\n\nMai mult preocupat de sine, mai puțin concentrat.\n\nDistanțele nu mai pot fi estimate corect\n\nDe exemplu cu mașinile care circulă în sens opus sau în față.\n\nMai ales periculos pentru că nu sunt asigurat\n\nDacă fac accident sub influența alcoolului.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cât de des ați fost sub influența alcoolului pe drum fără a atrage atenția și ce concluzionați din aceasta?",
                "answer": "Din păcate am condus deseori sub influența alcoolului, ignorând riscurile. Sau cu rest alcool în sânge, da, am condus! Asta a fost iresponsabil din partea mea. Îmi pare rău!",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Gânduri, sentimente după delict?",
                "answer": "După delict, situație jenantă, mi-a fost rușine! Am fost nepăsător și egoist. Mi-am dat seama de gravitatea greșelii mele și faptul că i-am rănit pe prietenii mei și pe mine în trafic, ceea ce nu mi-aș fi dorit niciodată pentru nimeni. Înțeleg că am o problemă cu alcoolul și înțeleg pericolul pe care l-am reprezentat în trafic!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cum v-ați descurcat cu alcoolul după delict? Cine sau ce va motivat să vă schimbați comportamentul? Care a fost punctul de cotitură?",
                "answer": "După ce mi-am pierdut permisul de conducere, nu am știut ce să fac, de necaz am băut mai departe următoarele două luni, și în Decembrie de Crăciun la data de 25.12.2022, am băut ultimele două beri.  Punctul de cotitură a fost accidentul, delictul, m-am trezit la realitate, a fost un șoc pentru mine.  Am înțeles și m-am decis să-mi schimb comportamentul pentru viitorul meu, pentru familia mea, dar și pentru societate. Am realizat că o schimbare este necesară și vreau să mențin această schimbare permanent.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Din ce alte motive ați mai renunțat la alcool?",
                "answer": "Am realizat că nu am control asupra consumului și că acesta îmi provoacă probleme în viață.\n\nCerturi și situații jenante!\n\nNeglijarea hobby-urilor!\n\nAm realizat că alcoolul îmi afectează negativ sănătatea și bunăstarea generală.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Va fost ușor să renunțați la alcool?",
                "answer": "Nu!, nu a fost ușor, a fost neobișnuit să nu mai beau ca înainte alcool, nu a fost o problemă fizică, dar gândurile la alcool, au fost la început prezente, la zile de nașteri, petreceri.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "De ce nu ați renunțat mai devreme la alcool?",
                "answer": "În trecut, nu mi-am pus niciodată problema să renunț la băut, deoarece nu am avut grijă de sănătatea mea. Credeam că alcoolul mă ajută să fac față stresului și îmi ușurează relațiile sociale. Consumul de alcool era considerat cel mai normal lucru din lume la petreceri și nu m-am gândit la consecințele negative asupra corpului meu.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cât și cât de des ați consumat? Trecut:",
                "answer": "Între 20 și 30 de ani \n\nAm locuit în Grecia, am băut 3-4 beri de 0,5 litri și 2 duble de două sau trei ori pe lună, mai ales în weekend, de obicei la ocazii speciale sau la restaurant.\n\nDe la 30 la 32 de ani\n\nDin Ianuarie 2019, când am venit în Germania, mi-am schimbat comportamentul de a bea în mod negativ, am început să beau regulat. Cantitatea de băutură a crescut! Diferit după muncă, de obicei miercuri, joi 2-3 beri. În weekend 5-6, 7-8, 9-10 beri.\n\nCantități maxime\n\nLa fiecare 2 luni 14 beri + 5 duble, deci de aproximativ 6 ori pe an.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "De ce ați băut? Cauze?",
                "answer": "Cauza o văd la mine în trecut și se află în gândurile și sentimentele mele.\n\nÎn România, părinții mei sau ocupat de noi, suntem patru frați, doi băieți și două fete. Școala am terminat-o la 15 ani a fost bine, mi-a plăcut.\n\nAm plecat în Grecia, sora a locuit în Grecia, la 17 ani la lucru, am lucrat la construcții, la restaurant, la 22 de ani m-am căsătorit și am un băiat cu fosta mea nevasta. M-am despărțit de fosta mea nevastă în 2018 și am venit în Germania în 2019, am avut 30 de ani, pe de o parte o viață nouă, a fost greu, dar și despărțirea de fosta mea nevastă, de copilul meu, despărțirea de foștii mei prieteni și familie, de grupul meu stabil de apartenență și recunoaștere, m-am simțit singur și pierdut. \n\nAm început să consum alcool regulat, la început și singur, da!\n\nConsumul de alcool m-a ajutat să-mi reduc stresul și să uit de probleme. \n\nAm găsit prieteni români la locul de muncă și am început să beau împreună cu ei, simțindu-mă acceptat. \n\nDoream să fiu pe placul tuturor, i-am ajutat pe toți și nu am putut spune \"nu\", mi-a fost teamă să fiu respins. Nu m-am arătat slab și nu am vorbit cu nimeni despre problemele mele. În final, am pierdut controlul asupra consumului de alcool.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cum faci față stresului în viața ta de astăzi? Cum ai redus stresul?",
                "answer": "Acum vorbesc deschis și sincer despre problemele mele. Îmi exprim limitele și spun \"Nu\".",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
             // Frage 17: Umbenannt von "Ce vorbește împotriva faptului că nu erați dependent de alcool?"
            {
                "question": "De ce credeți că nu ați fost dependent de alcool?",
                "answer": "Nu am avut probleme de sevraj, deci probleme fizice!\n\nM-am oprit fără ajutor.\n\nNu am băut cantități mari în timpul săptămânii. Nu am băut nimic dimineața.\n\nMi-am respectat Terminele.\n\nNu am fost în spital, nu am făcut Terapie.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Schimbări! Ce sa schimbat în viața dvs. de când nu mai consumați?",
                "answer": "Totul a devenit mai pozitiv ca urmare a faptului că nu mai beau:\n\nMă simt mai bine, mai sănătos. Este mai bine în relație.(Am o prietenă de doi ani!)\n\nLa serviciu, am mai mult spor și energie, am colegi noi.\n\nMi-am reînviat vechile hobby-uri. Fac din nou mai mult sport, bicicleta, plimbări cu prietena, cu copii in natură.\n\nTimpul pe care îl petreceam în weekend consumând alcool, l-am înlocuit acum cu hobby-urile și familia.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
             // Frage 19: Umbenannt von "Care ar fi Situațiile Riscante în care noul comportament al consumului de alcool ar putea fi expus riscului?"
            {
                "question": "Care ar fi Situațiile Riscante?",
                "answer": "Situații riscante\n\nanumite crize de viață pot fi periculoase, cum ar fi moartea unei persoane dragi, boli grave, pierderea locului de muncă, frică, schimbări de dispoziție, pierderea unui partener sau îmbolnăvirea gravă. În fiecare caz nu aș bea alcool. Mi-aș găsi sprijinul în familie. Continui să trăiesc, privesc înainte.\n\nSituație riscantă(Cineva îmi oferă alcool în viitor la o zi de naștere!)\n\nDacă cineva îmi oferă alcool în viitor, fie la o zi de naștere sau la o petrecere, îi voi spune că nu mai beau alcool pentru că am o problemă cu alcoolul și că văd orice consum ca o pură pierdere de timp! Îmi place să ciocnesc paharele, dar numai cu apă! Îi voi recomanda să facă la fel. Comand băuturi nealcoolice. Evit evenimentele în care experiența a arătat că oamenii beau mult.\n\nSituație riscantă (Mă întâlnesc întâmplător cu vechii mei prieteni și unul dintre ei îmi aduce o bere!)\n\nspun, nu mulțumesc, nu beau alcool, prefer să beau cola! La următoarea ofertă! Nu, mulțumesc, prefer să beau Cola! Dacă nu se oprește, ameninț că plec și mă ridic în mod demonstrativ.",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Unde vedeți riscul de recidivă „a bea din nou, a face același delict din nou“, De ce este Riscul de recidivă minimal?",
                "answer": "În viitor, vreau să respect legea, pentru că nu mai vreau să pun viața nimănui în pericol. Desigur, nimeni nu poate da 100%.\n\nRiscul este minimal pentru că:\n\nAstăzi vorbesc cu alții (prietena care mă sprijină) despre problemele mele cât mai curând posibil.\n\nNu mă mai arăt permanent puternic, pot să arăt că sunt și slab.\n\nAm învățat să spun „Nu”, nu le mai fac pe plac la toți!\n\nCunosc Situațiile Riscante, știu despre dorința mea de a fi acceptat și de a aparține, îmi cunosc cauzele consumului!",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Plan de urgență (o Listă) după o recidivă(dacă beau din nou!)?",
                "answer": "Numărul de telefon al consultantului MPU care este întotdeauna disponibil!\n\nO Listă: Indică ce se întâmplă dacă continui să consumi: Datorii, separare, pierderea locului de muncă, boală etc.! Riscul de a pierde tot ce am realizat până acum! Sănătate, prieteni, Sport, bani, hobby-uri!",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ce ați învățat în timpul pregătirii MPU?",
                "answer": "Am vorbit despre delict\n\nL-am analizat și am găsit greșelile mele.\n\nGreșeli: Am crezut că nu voi fi prins! Am fost un Egoist! Nu am respectat legea: Am condus sub influența alcoolului! Am fost un pericol pentru mine și pentru alții!\n\nCunosc cauzele consumului meu, dorința mea de recunoaștere și apartenență!\n\nȘtiu că alcoolul este otravă pentru nervi și celule, este dăunător sănătății.\n\nPoate duce la dependență. Cu fiecare intoxicație, celulele creierului mor.\n\nConsumul regulat de băut duce la o memorie slabă și la scăderea inteligenței.\n\nȘtiu ce este memoria dependenței (creierul își va aminti întotdeauna nivelurile maxime).\n\nȘtiu ce înseamnă creșterea toleranței (alcoolul devine din ce în ce mai mult).\n\nȘtiu ce este consumul excesiv de alcool, atunci când cinci sau mai multe pahare de alcool sunt băute de o dată.\n\nRiscul de a comite un delict identic nu poate fi exclus.\n\nAm discutat despre avantajele și dezavantajele. Sunt pregătit pentru viitor.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Credeți că ar trebui să vă reprimiți permisul de conducere, vreți neapărat carnetul înapoi?",
                "answer": "Nu neapărat, dar cred că ar fi frumos dacă mi-aș obține permisul de conducere înapoi. \n\nM-ai important este pentru mine însă faptul că mi-am schimbat comportamentul, nu mai vreau să fiu un pericol pentru nimeni, când particip la traficul rutier. Pentru că nu mai vreau să pun în pericol viața mea nouă.",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Mai aveți ceva de adăugat pentru a încheia?",
                "answer": "Cred că retragerea permisului de conducere nu este atât de grav, deoarece este o învățătură de minte pentru mine. \n\nDacă nu mi s-ar fi întâmplat asta, atunci nu aș fi schimbat nimic în viață. Sunt recunoscător pentru asta!",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Când ați intrat pentru prima dată în contact cu alcoolul și când ați consumat pentru prima dată?",
                "answer": "La vârsta de 14 ani am probat o înghițitură de bere pentru prima dată. Nu mi-a plăcut atunci deloc!",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Care au fost aspectele pozitive ale consumului de alcool?",
                "answer": "În primul rând, era plăcut. Mă simțeam relaxat și vesel. Un alt lucru pozitiv era că mă simțeam în largul meu și social în compania prietenilor, mai vorbăreț și deschis. Alcoolul avea uneori și un efect distractiv, îmi ridica starea de spirit.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Care au fost aspectele negative ale consumului de alcool?",
                "answer": "A doua zi m-am luptat cu dureri de cap, greață, oboseală și lipsă de putere. Eram obosit, nemotivat, o persoană complet diferită!",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cu puțin și cu mult alcool?",
                "answer": "Cu puțin alcool, adică una-două sticle de bere, mă simțeam relaxat și vesel, nu am avut plângeri a doua zi. Însă cu mult alcool, aproximativ 5-6 sticle de bere, lucrurile se schimbau. Mă confruntam cu dureri de cap, greață și oboseală excesivă a doua zi. Nu îmi mai puteam desfășura activitatea normal.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Unde și cu cine ați consumat mai ales?",
                "answer": "Am consumat alcool în special în compania prietenilor și colegilor de muncă. De obicei ieșeam în oraș miercuri, joi seara după muncă pentru o bere la un local. De asemenea, băusem la petreceri, nunți sau evenimente importante alături de cunoscuți. Astfel, momentele de relaxare în gașcă erau asociate cu băuturile alcoolice. În trecut, pentru a mă simți acceptat în cercul de prieteni, beam la fel ca ei.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ați fost vreodată întrebat despre consumul de alcool?",
                "answer": "Da, din mai multe părți (familia, mama). Ar bea prea mult. Dar am considerat că consumul meu este normal. Am ignorat toate lucrurile.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Au existat probleme cu prietena sau familia, la lucru din cauza consumului de alcool?",
                "answer": "Bineînțeles, ne-am certat deseori din cauza consumului de alcool, la lucru, luni fără putere, obosit, da, am avut probleme să mă concentrez la muncă!",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "V-ați simțit vinovat câteodată de consumul de alcool?",
                "answer": "Da, sigur! Mai ales când ai un cap mare a doua zi. Dar două zile mai târziu uitasem deja, știam că trebuie să fac ceva. A rămas însă gândul, nu am făcut nimic.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cum evaluați consumul, ați pierdut vreodată controlul asupra cantităților de băut?",
                "answer": "În trecut am avut probleme cu alcoolul și am pierdut de câteva ori controlul cantităților consumate, ajungând să mă îmbăt peste măsură. S-a întâmplat de aproximativ 6 ori pe an. De obicei beam bere, dar uneori țuică, ceea ce mă făcea să-mi pierd frânele mai repede. Trebuie să recunosc că nu știam să mă opresc la timp.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Dacă au apărut rupturi de film din cauza consumului de alcool, adică dacă după un consum excesiv de alcool ați uitat părți din seara în care ați băut excesiv?",
                "answer": "Da, în perioada în care consumam foarte mult alcool, de câteva ori am avut rupturi de film după o seara în care băusem în exces. Erau deja câteva porțiuni din seara petrecută pe care nu mi le mai aduceam aminte. Acesta era un semn clar că depășisem limita sigură și alcoolul îmi afecta memoria.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "V-ați abținut în mod conștient și deliberat de a consuma alcool în trecut sau mai des pe o perioadă mai lungă de timp? Ați avut pauze de băut?",
                "answer": "Sincer, nu am avut pauze de băut și nu au existat niciodată încercări de abstinență. Nu, nu m-am abținut conștient și deliberat de a consuma alcool pe o perioadă mai îndelungată de timp. Deși uneori, după o seara de beție, îmi dădeam seama că nu controlasem bine situația și că ar fi trebuit să reduc cantitatea consumată, nu luam măsuri concrete să mă las. Greșeala mea a fost că uitam prea curând de problemele provocate de alcool și nu înțelegeam faptul că abuzam deja de el.",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "În ce categorie de băutori va vedeți astăzi retrospectiv? Cum ați evalua comportamentul dvs. de băut până la data infracțiunii?",
                "answer": "Astăzi mă văd în abuz, cantitățile de alcool au fost ridicate și problematice.\n\nScala la 8. (sub mediu - mediu - abuziv - dependent)? \n\n                                         Scala 1 2 3 4 5 6 7 8 9 10",
                "category": "alcohol" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Beți alcool astăzi? Dacă da, ce, cât și cât de des? Beți bere fără alcool? Vă puteți imagina să beți una sau două beri în viitor?",
                "answer": "Sunt abstinent de mai mult de un an! Nu! Nu, nu beau bere fără alcool, acord în mod conștient atenție la ceea ce mănânc și dacă există alcool în băuturi, alimente sau medicamente. În cazul medicamentelor, întreb dacă există alternative fără alcool. Nu! am probleme cu alcoolul, știu că nu va rămâne doar la o bere!",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ce contact aveți momentan cu gașca, cu care ați consumat?",
                "answer": "Între timp nu mai am niciun contact cu clica mea. Când mi-am exprimat dorința de a nu mai bea alcool, unii dintre foștii prieteni nu au fost în stare să mă înțeleagă sau să mă accepte. Majoritatea întâlnirilor noastre se desfășurau în locuri unde se consuma băuturi alcoolice. Acum evit astfel de evenimente sau localuri. În cercul meu actual de prieteni, consumul intensiv de alcool nu ar fi acceptat.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ați fost un șofer sigur?",
                "answer": "Nu, altfel nu aș fi la MPU, deoarece șoferii foarte buni nu trebuie să meargă la MPU!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cum apreciați faptul că până la accident nu ați avut niciodată un accident mai mare?",
                "answer": "A fost doar noroc!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "De ce avem atâtea reguli și legi?",
                "answer": "Avem nevoie de reguli. Regulile ne protejează. Am înțeles că dacă respect regulile voi trăi în siguranță și în pace. Fără reguli ar fi doar haos.",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Cum vă vedeți ca șofer în trecut?",
                "answer": "Am fost un șofer egoist și neglijent, mă gândeam doar la mine și nu la consecințe! Îmi pare rău!",
                "category": "incident" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ce credeți că este un șofer bun, normal?",
                "answer": "Un șofer de mașină bun este cineva care respectă regulile, este atent, se gândește la alții și nu mai reprezintă un pericol în trafic!",
                "category": "future" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Câte persoane trebuie să meargă la MPU pe an?",
                "answer": "90.000 de persoane în anul 2019, din cauza alcoolului 40%, droguri și medicamente cu 30%, puncte 18%, restul 12%.",
                "category": "intro" // Kategorie hinzugefügt (Beispiel)
            },
            {
                "question": "Ultima dată când ați spus Nu?",
                "answer": "Am refuzat unui prieten care sa mutat pentru a cincea oară în doi ani și care a avut nevoie din nou de oameni pentru a transporta cutii.",
                "category": "recovery" // Kategorie hinzugefügt (Beispiel)
            }
        ];
        // *** ENDE NEUE DATENBANK ***

        // Variablen für die Anwendungsfunktionalität (unverändert)
        let currentQuestion = null;
        let currentCategory = 'all';
        let recordedAnswers = {};
        let savedAnswers = {};
        let mediaRecorder = null;
        let audioChunks = [];
        let recordingTimer = null;
        let recordingSeconds = 0;
        let answeredQuestions = new Set();

        // DOM-Elemente initialisieren
        document.addEventListener('DOMContentLoaded', function() {
            const darkModeToggle = document.getElementById('darkModeToggle');
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.body.classList.add('dark');
            }
            darkModeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark');
            });

            // Event-Listener für Kategorie-Tabs (jetzt im oberen Container)
            document.querySelectorAll('.category-button-container .category-tab').forEach(tab => {
                 // Prüfen, ob es der Extra-Guide-Button ist, um keinen Kategorie-Listener hinzuzufügen
                 if (!tab.classList.contains('guide-extra-button')) {
                    tab.addEventListener('click', function() {
                        const category = this.getAttribute('data-category');
                        // Überprüfen, ob die Kategorie gültig ist (optional, aber gut für Robustheit)
                        const validCategories = ['all', 'intro', 'incident', 'alcohol', 'recovery', 'future'];
                        if (validCategories.includes(category)) {
                            currentCategory = category;

                            document.querySelectorAll('.category-button-container .category-tab').forEach(t => t.classList.remove('active'));
                            this.classList.add('active');

                            showQuestionsByCategory(category);
                            // Suche zurücksetzen beim Kategorie-Wechsel
                            document.getElementById('searchInput').value = '';
                        } else {
                            console.error("Ungültige Kategorie:", category);
                        }
                    });
                }
            });

            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                filterQuestions(searchTerm);
            });

            // Guide-Button wurde entfernt, aber Modal-Logik bleibt für spätere Verwendung
            const showGuideButton = document.getElementById('showGuideButton');
            if (showGuideButton) { // Prüfen, ob der Button noch existiert
                showGuideButton.addEventListener('click', function() {
                    document.getElementById('guideModal').style.display = 'flex';
                });
            }
            document.getElementById('closeGuideModal').addEventListener('click', function() {
                document.getElementById('guideModal').style.display = 'none';
            });
            window.addEventListener('click', function(event) {
                if (event.target == document.getElementById('guideModal')) {
                    document.getElementById('guideModal').style.display = 'none';
                }
            });

            document.getElementById('backToList').addEventListener('click', function() {
                document.getElementById('questionDetail').classList.add('hidden');
                document.getElementById('questionListContainer').classList.remove('hidden');
            });

            document.getElementById('recordAnswerBtn').addEventListener('click', function() {
                document.getElementById('recordingContainer').classList.toggle('hidden');
            });

            document.getElementById('recordButton').addEventListener('click', toggleRecording);
            document.getElementById('reRecordButton').addEventListener('click', function() {
                document.getElementById('audioContainer').classList.add('hidden');
                toggleRecording(); // Neue Aufnahme starten
            });
            document.getElementById('saveRecordingButton').addEventListener('click', function() {
                if (currentQuestion) {
                    const audioURL = document.getElementById('audioPlayer').src;
                    if (audioURL && audioURL.startsWith('blob:')) { // Sicherstellen, dass eine gültige Blob-URL vorhanden ist
                         recordedAnswers[currentQuestion.question] = audioURL;
                         updateRecordedAnswersCount();
                         alert('Înregistrarea ta a fost salvată!');
                         // Kartenstatus in der Listenansicht aktualisieren
                         updateQuestionCardStatus(currentQuestion.question);
                    } else {
                        alert('Nu există o înregistrare validă de salvat.');
                    }
                }
            });
            document.getElementById('saveAnswerBtn').addEventListener('click', function() {
                if (currentQuestion) {
                    savedAnswers[currentQuestion.question] = true;
                    // Sicherstellen, dass der Aufnahmestatus nicht überschrieben wird, wenn beides wahr ist
                    if (!recordedAnswers[currentQuestion.question]) {
                         recordedAnswers[currentQuestion.question] = false; // Als gespeichert, aber nicht aufgenommen markieren
                    }
                    updateSavedAnswersCount();
                    alert('Răspunsul a fost marcat ca salvat!');
                     // Kartenstatus in der Listenansicht aktualisieren
                    updateQuestionCardStatus(currentQuestion.question);
                }
            });

            document.getElementById('prevQuestionButton').addEventListener('click', showPreviousQuestion);
            document.getElementById('nextQuestionButton').addEventListener('click', showNextQuestion);

            // Initialisierung: Alle Fragen anzeigen
            showQuestionsByCategory('all');
            updateTotalQuestions();

            // Werbebanner initialisieren (nachdem das DOM bereit ist)
            initializeAdBanner();
        });

        // --- JavaScript-Funktionen (größtenteils unverändert, außer Banner) ---

        function showQuestionsByCategory(category) {
            const questionList = document.getElementById('questionList');
            questionList.innerHTML = ''; // Liste leeren

             // Sicherstellen, dass qa_data definiert und ein Array ist
            if (!Array.isArray(qa_data)) {
                console.error("qa_data ist nicht definiert oder kein Array.");
                questionList.innerHTML = '<p class="text-center text-red-500 py-4">Fehler: Fragen konnten nicht geladen werden.</p>';
                return;
            }

            const filteredQuestions = category === 'all'
                ? qa_data
                : qa_data.filter(q => q.category === category);

            if (filteredQuestions.length === 0) {
                questionList.innerHTML = '<p class="text-center text-gray-500 py-4">Nu s-au găsit întrebări în această categorie.</p>';
                return;
            }
            filteredQuestions.forEach(question => {
                 // Überprüfen, ob die Frage ein gültiges Objekt ist
                 if (question && typeof question === 'object' && question.question) {
                    const questionCard = createQuestionCard(question);
                    questionList.appendChild(questionCard);
                 } else {
                     console.warn("Ungültiges Fragenobjekt übersprungen:", question);
                 }
            });
            questionList.scrollTop = 0; // Zum Anfang der Liste scrollen
        }


        function filterQuestions(searchTerm) {
            const questionList = document.getElementById('questionList');
            questionList.innerHTML = ''; // Liste leeren

            // Sicherstellen, dass qa_data definiert und ein Array ist
            if (!Array.isArray(qa_data)) {
                console.error("qa_data ist nicht definiert oder kein Array.");
                questionList.innerHTML = '<p class="text-center text-red-500 py-4">Fehler: Fragen konnten nicht geladen werden.</p>';
                return;
            }

            let filteredQuestions = currentCategory === 'all'
                ? qa_data
                : qa_data.filter(q => q.category === currentCategory);

            if (searchTerm) {
                filteredQuestions = filteredQuestions.filter(q =>
                    q && q.question && q.question.toLowerCase().includes(searchTerm) || // Prüfen ob q.question existiert
                    q && q.answer && q.answer.toLowerCase().includes(searchTerm)    // Prüfen ob q.answer existiert
                );
            }

            if (filteredQuestions.length === 0) {
                questionList.innerHTML = '<p class="text-center text-gray-500 py-4">Nu s-au găsit întrebări pentru această căutare.</p>';
                return;
            }
            filteredQuestions.forEach(question => {
                // Überprüfen, ob die Frage ein gültiges Objekt ist
                 if (question && typeof question === 'object' && question.question) {
                    const questionCard = createQuestionCard(question);
                    questionList.appendChild(questionCard);
                 } else {
                     console.warn("Ungültiges Fragenobjekt übersprungen:", question);
                 }
            });
        }


        function createQuestionCard(question) {
            const card = document.createElement('div');
            // Erstellen einer sichereren ID
            const questionId = 'card-' + (question.question || 'no-question').replace(/[^a-zA-Z0-9]/g, '-').substring(0, 50);
            card.id = questionId;
            card.className = 'question-card bg-gray-50 rounded-lg p-4 hover:bg-gray-100 cursor-pointer';
            card.innerHTML = generateCardContent(question);
            card.addEventListener('click', () => showQuestionDetail(question));
            return card;
        }

        function generateCardContent(question) {
             let statusIndicator = '';
             // Prüfen, ob question und question.question existieren
             const questionText = question && question.question;
             if (!questionText) return ''; // Leeren Inhalt zurückgeben, wenn keine Frage vorhanden ist

             if (savedAnswers[questionText]) {
                statusIndicator = `<span class="status-indicator inline-block px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 ml-2">Salvat</span>`;
            } else if (recordedAnswers[questionText] && recordedAnswers[questionText] !== false) {
                statusIndicator = `<span class="status-indicator inline-block px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800 ml-2">Înregistrat</span>`;
            } else if (answeredQuestions.has(questionText)) {
                statusIndicator = `<span class="status-indicator inline-block px-2 py-1 text-xs rounded-full bg-gray-200 text-gray-700 ml-2">Vizualizat</span>`;
            }
            const categoryLabel = getCategoryLabel(question.category); // Kategorie-Label holen
            return `
                <div class="flex justify-between items-start">
                    <span class="inline-block px-2 py-1 text-xs rounded-full bg-indigo-100 text-indigo-800 mb-2">${categoryLabel}</span>
                    ${statusIndicator}
                </div>
                <h3 class="font-semibold text-gray-800 mb-1">${questionText}</h3>
            `;
        }

        function updateQuestionCardStatus(questionText) {
             if (!questionText) return; // Abbruch, wenn kein Fragetext vorhanden ist
             const questionId = 'card-' + questionText.replace(/[^a-zA-Z0-9]/g, '-').substring(0, 50);
             const cardElement = document.getElementById(questionId);
             if (cardElement) {
                 const questionData = qa_data.find(q => q && q.question === questionText); // Sicherstellen, dass q existiert
                 if (questionData) {
                     cardElement.innerHTML = generateCardContent(questionData);
                 }
             }
        }


        function showQuestionDetail(question) {
             // Sicherstellen, dass question ein gültiges Objekt ist
             if (!question || typeof question !== 'object' || !question.question) {
                 console.error("Ungültiges Fragenobjekt an showQuestionDetail übergeben:", question);
                 // Optional: Fehlermeldung anzeigen
                 document.getElementById('questionTitle').textContent = "Eroare la încărcarea întrebării.";
                 document.getElementById('questionAnswer').innerHTML = "";
                 return;
             }

            currentQuestion = question;
            document.getElementById('questionListContainer').classList.add('hidden');
            document.getElementById('questionDetail').classList.remove('hidden');
            document.getElementById('questionCategory').textContent = getCategoryLabel(question.category); // Kategorie-Label holen
            document.getElementById('questionTitle').textContent = question.question;
            document.getElementById('questionAnswer').innerHTML = question.answer || ""; // Fallback für leere Antwort
            document.getElementById('recordingContainer').classList.add('hidden');
            document.getElementById('audioContainer').classList.add('hidden');
            document.getElementById('recordingTime').textContent = '00:00';
            recordingSeconds = 0;
            const recordButton = document.getElementById('recordButton');
            recordButton.classList.remove('recording');
            document.getElementById('recordingIndicator').classList.add('hidden');

            // Audio-Player nur anzeigen, wenn eine gültige Aufnahme existiert
            if (recordedAnswers[question.question] && recordedAnswers[question.question] !== false) {
                document.getElementById('recordingContainer').classList.remove('hidden');
                document.getElementById('audioContainer').classList.remove('hidden');
                document.getElementById('audioPlayer').src = recordedAnswers[question.question];
            }

            // Frage als gesehen markieren und Fortschritt aktualisieren
            if (!answeredQuestions.has(question.question)) {
                answeredQuestions.add(question.question);
                updateProgress();
                updateQuestionCardStatus(question.question);
            }
            document.getElementById('questionDetail').scrollTop = 0; // Nach oben scrollen
        }

        function getCategoryLabel(category) {
            // Standardkategorien definieren
            const labels = { 'intro': 'Introducere', 'incident': 'Incident', 'alcohol': 'Alcool', 'recovery': 'Recuperare', 'future': 'Viitor' };
            // Fallback auf den technischen Namen, wenn keine Übersetzung vorhanden ist
            return labels[category] || category || 'Necategorisit'; // Fallback für undefinierte Kategorie
        }


        function showNextQuestion() {
            if (!currentQuestion || !currentQuestion.question) return; // Sicherstellen, dass currentQuestion gültig ist
             // Aktuelle Liste basierend auf Kategorie und Suchbegriff filtern
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            let currentList = currentCategory === 'all'
                ? qa_data
                : qa_data.filter(q => q && q.category === currentCategory); // Sicherstellen, dass q existiert
             if (searchTerm) {
                currentList = currentList.filter(q =>
                    q && q.question && q.question.toLowerCase().includes(searchTerm) ||
                    q && q.answer && q.answer.toLowerCase().includes(searchTerm)
                );
            }
             // Nur gültige Fragenobjekte in der Liste behalten
             currentList = currentList.filter(q => q && q.question);

            if (currentList.length === 0) return; // Keine Fragen in der gefilterten Liste

            const currentIndex = currentList.findIndex(q => q.question === currentQuestion.question);
            if (currentIndex === -1) return; // Aktuelle Frage nicht in der Liste gefunden

            const nextIndex = (currentIndex + 1) % currentList.length;
            showQuestionDetail(currentList[nextIndex]);
        }

        function showPreviousQuestion() {
            if (!currentQuestion || !currentQuestion.question) return; // Sicherstellen, dass currentQuestion gültig ist
            // Aktuelle Liste basierend auf Kategorie und Suchbegriff filtern
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            let currentList = currentCategory === 'all'
                ? qa_data
                : qa_data.filter(q => q && q.category === currentCategory); // Sicherstellen, dass q existiert
             if (searchTerm) {
                currentList = currentList.filter(q =>
                    q && q.question && q.question.toLowerCase().includes(searchTerm) ||
                    q && q.answer && q.answer.toLowerCase().includes(searchTerm)
                );
            }
             // Nur gültige Fragenobjekte in der Liste behalten
             currentList = currentList.filter(q => q && q.question);

            if (currentList.length === 0) return; // Keine Fragen in der gefilterten Liste

            const currentIndex = currentList.findIndex(q => q.question === currentQuestion.question);
             if (currentIndex === -1) return; // Aktuelle Frage nicht in der Liste gefunden

            const prevIndex = (currentIndex - 1 + currentList.length) % currentList.length;
            showQuestionDetail(currentList[prevIndex]);
        }


        function toggleRecording() {
            const recordButton = document.getElementById('recordButton');
            const recordingIndicator = document.getElementById('recordingIndicator');
            if (recordButton.classList.contains('recording')) {
                if (mediaRecorder && mediaRecorder.state === 'recording') {
                    mediaRecorder.stop();
                    clearInterval(recordingTimer);
                }
                recordButton.classList.remove('recording');
                recordingIndicator.classList.add('hidden');
            } else {
                recordButton.classList.add('recording');
                recordingIndicator.classList.remove('hidden');
                startRecording();
            }
        }

        function startRecording() {
            audioChunks = [];
            recordingSeconds = 0;
            updateRecordingTime();
            recordingTimer = setInterval(() => {
                recordingSeconds++;
                updateRecordingTime();
            }, 1000);

            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                    mediaRecorder = new MediaRecorder(stream);
                    mediaRecorder.addEventListener('dataavailable', event => { audioChunks.push(event.data); });
                    mediaRecorder.addEventListener('stop', () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                        const audioUrl = URL.createObjectURL(audioBlob);
                        document.getElementById('audioPlayer').src = audioUrl;
                        document.getElementById('audioContainer').classList.remove('hidden');
                        // Stream-Tracks stoppen, um das Mikrofon freizugeben
                        stream.getTracks().forEach(track => track.stop());
                    });
                    mediaRecorder.start();
                })
                .catch(error => {
                    console.error('Eroare la accesarea microfonului:', error);
                    alert('Eroare la accesarea microfonului. Verificați permisiunile.');
                    const recordButton = document.getElementById('recordButton');
                    recordButton.classList.remove('recording');
                    document.getElementById('recordingIndicator').classList.add('hidden');
                    clearInterval(recordingTimer);
                });
        }

        function updateRecordingTime() {
            const minutes = Math.floor(recordingSeconds / 60);
            const seconds = recordingSeconds % 60;
            document.getElementById('recordingTime').textContent =
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function updateTotalQuestions() {
             // Sicherstellen, dass qa_data ein Array ist
            const totalQuestions = Array.isArray(qa_data) ? qa_data.length : 0;
            const answeredCount = answeredQuestions.size;
            document.getElementById('answeredQuestions').textContent = `${answeredCount}/${totalQuestions}`;
        }


        function updateProgress() {
             // Sicherstellen, dass qa_data ein Array ist
            const totalQuestions = Array.isArray(qa_data) ? qa_data.length : 0;
            const answeredCount = answeredQuestions.size;
            document.getElementById('answeredQuestions').textContent = `${answeredCount}/${totalQuestions}`;
            const progressBar = document.getElementById('progressBar');
            // Sicherstellen, dass progressBar existiert
            if (progressBar) {
                progressBar.style.width = totalQuestions > 0 ? `${(answeredCount / totalQuestions) * 100}%` : '0%';
            }
            updateRecordedAnswersCount();
            updateSavedAnswersCount();
        }


        function updateRecordedAnswersCount() {
            // Nur gültige Aufnahme-URLs zählen, keine 'false'-Platzhalter
            const recordedCount = Object.values(recordedAnswers).filter(val => val && val !== false).length;
            const recordedAnswersElement = document.getElementById('recordedAnswers');
            // Sicherstellen, dass das Element existiert
            if (recordedAnswersElement) {
                recordedAnswersElement.textContent = recordedCount;
            }
        }

        function updateSavedAnswersCount() {
            const savedCount = Object.keys(savedAnswers).length;
            const savedAnswersElement = document.getElementById('savedAnswers');
             // Sicherstellen, dass das Element existiert
            if (savedAnswersElement) {
                savedAnswersElement.textContent = savedCount;
            }
        }


        // --- JavaScript für Werbebanner ---
        let adBannerTimeoutId = null; // Variable zur Steuerung des Timeouts

        // Typewriter-Funktion für Banner
        function typeWriter(textElement, cursorElement, text, speed = 70, eraseDelay = 3000) { // Geschwindigkeit und Verzögerung angepasst
            let i = 0;
            textElement.innerHTML = "";
            cursorElement.style.display = "inline-block"; // Cursor anzeigen
            // Vorherigen Timeout stoppen, um Überlappungen zu vermeiden
            if (adBannerTimeoutId) clearTimeout(adBannerTimeoutId);

            function typing() {
                if (i < text.length) {
                    textElement.innerHTML += text.charAt(i);
                    i++;
                    adBannerTimeoutId = setTimeout(typing, speed);
                } else {
                    // Nach dem Schreiben warten, bevor gelöscht wird
                    adBannerTimeoutId = setTimeout(eraseText, eraseDelay);
                }
            }

            function eraseText() {
                if (textElement.innerHTML.length > 0) {
                    textElement.innerHTML = textElement.innerHTML.substring(0, textElement.innerHTML.length - 1);
                    adBannerTimeoutId = setTimeout(eraseText, speed / 2); // Schneller löschen
                } else {
                    // Wenn der Text gelöscht ist, zum nächsten übergehen
                    cursorElement.style.display = "none"; // Cursor ausblenden, bevor der Text wechselt
                    adBannerTimeoutId = setTimeout(nextAdText, 500); // Kurze Pause vor dem nächsten Text
                }
            }

            typing(); // Schreiben starten
        }

        // Nachrichten für den Banner (MPU-Tipps)
        const adMessages = [
          "Exersează răspunsurile MPU cu exemple personale detaliate!",
          "Ia-ți timp să te gândești. O pauză scurtă înainte de a răspunde pare mai naturală.",
          "Folosește formulări precum 'Am învățat că...' sau 'Am experimentat...' în loc de 'Trebuie să...'",
          "Evită să răspunzi prea rapid sau să folosești excesiv termeni tehnici."
        ];

        let currentAdIndex = 0;
        let textGlowElement = null; // Mit null initialisieren
        let cursorElement = null;   // Mit null initialisieren

        function nextAdText() {
          if (!textGlowElement || !cursorElement) return; // Prüfen, ob Elemente existieren
          currentAdIndex = (currentAdIndex + 1) % adMessages.length;
          typeWriter(textGlowElement, cursorElement, adMessages[currentAdIndex]);
        }

        // Spezifische Initialisierungsfunktion für den Banner
        function initializeAdBanner() {
            textGlowElement = document.querySelector("#ad-banner .text-glow");
            cursorElement = document.querySelector("#ad-banner .cursor");

            // Prüfen, ob Bannerelemente existieren, bevor gestartet wird
            if (textGlowElement && cursorElement) {
                // Animationen beim Hover auf Banner stoppen
                const adBanner = document.getElementById("ad-banner");
                adBanner.addEventListener("mouseenter", () => {
                    if (textGlowElement) textGlowElement.style.animationPlayState = "paused";
                    if (cursorElement) cursorElement.style.animationPlayState = "paused";
                    // Schreib-/Lösch-Timeout stoppen
                    if (adBannerTimeoutId) clearTimeout(adBannerTimeoutId);
                });

                adBanner.addEventListener("mouseleave", () => {
                    if (textGlowElement) textGlowElement.style.animationPlayState = "running";
                    if (cursorElement) cursorElement.style.animationPlayState = "running";
                    // Schreib-/Löschvorgang fortsetzen (oder nächsten Zyklus starten)
                    // Hier starten wir den Zyklus zur Vereinfachung neu
                    if (adBannerTimeoutId) clearTimeout(adBannerTimeoutId); // Alten Timeout stoppen
                    // Mit aktuellem Text fortfahren, aber mit kleiner Verzögerung
                    typeWriter(textGlowElement, cursorElement, adMessages[currentAdIndex], 70, 500); // Kleine Verzögerung bei Wiederaufnahme
                });

                // Banner-Animation starten
                typeWriter(textGlowElement, cursorElement, adMessages[0]);
            } else {
                console.error("Bannerelemente (#ad-banner .text-glow oder .cursor) nicht gefunden!");
            }
        }

        // Restlicher JavaScript-Code der Anwendung bleibt unverändert...

    </script>
</body>
</html>
